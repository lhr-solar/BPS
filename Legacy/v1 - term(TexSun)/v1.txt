my modifications of archer's code
