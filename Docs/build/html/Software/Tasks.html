

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Real Time Operating System Tasks &mdash; BeVolt BPS 0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Board Support Package" href="BSP.html" />
    <link rel="prev" title="Design Overview" href="../Overview/design-overview.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> BeVolt BPS
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Overview/design-requirements.html">Design Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Overview/design-overview.html">Design Overview</a></li>
</ul>
<p class="caption"><span class="caption-text">Software</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Real Time Operating System Tasks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#fault-state-task-manthan-upadhyaya">Fault State Task: Manthan Upadhyaya</a></li>
<li class="toctree-l2"><a class="reference internal" href="#amperes-task-manthan-upadhyaya">Amperes Task: Manthan Upadhyaya</a></li>
<li class="toctree-l2"><a class="reference internal" href="#critical-state-task-manthan-upadhyaya">Critical State Task: Manthan Upadhyaya</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="BSP.html">Board Support Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="Apps.html">Application</a></li>
</ul>
<p class="caption"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BeVolt BPS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Real Time Operating System Tasks</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Software/Tasks.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="real-time-operating-system-tasks">
<h1>Real Time Operating System Tasks<a class="headerlink" href="#real-time-operating-system-tasks" title="Permalink to this headline">¶</a></h1>
<div class="section" id="fault-state-task-manthan-upadhyaya">
<h2>Fault State Task: Manthan Upadhyaya<a class="headerlink" href="#fault-state-task-manthan-upadhyaya" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>Purpose</dt>
<dd>The Fault State Task is called when a fault condition is set off in the BPS. These fault
conditions can be found here(place link to fault conditions).</dd>
<dt>Functionality:</dt>
<dd><ol class="first last arabic simple">
<li>All other tasks are not allowed to run unless they have are utilized sempahore. The other tasks will run (periodically according to the scheduler) until they post that semaphore and then they are prevented from running again. This occurs internally through the RTOS.</li>
<li>The contactor is turned off.</li>
<li>All the fans are set to maximum speed.</li>
<li>The proper LED’s are turned on and off. When the fault LED is turned on, the strobelight turns on.</li>
<li>The fault condition is logged into the EEPROM.</li>
<li>A message is sent along the CAN to the BPS display board to notify the driver that the BPS is tripped.</li>
<li>The WatchDog timer is continually reset to prevent the BPS from going into fault again.</li>
</ol>
</dd>
<dt>Priority</dt>
<dd>This task has the second highest priority when the Init task is running. However, after the init
task destroys itself, it has the highest priority.</dd>
<dt>Shared Resources</dt>
<dd>It uses the Fault_Sem4 which is used to block the task from running until something sets it. It
uses the VoltageBuffer_Sem4, TemperatureBuffer_Sem4, and AmperesIO_Sem4 to log data into the
EEPROM.</dd>
<dt>Timing Requirements</dt>
<dd>None</dd>
<dt>Yields</dt>
<dd>It will yield only if it tries to collect data with a semaphore already pending. This will only
be at the start of the task after it turns off the contactor.</dd>
<dt>Additional Considerations</dt>
<dd>Although the BPS goes into fault state when the battery is in danger, it also goes into fault
state when there is an issue with the RTOS. Since the BPS must always run during the race, care
must be taken to minimize the chances of this happening.</dd>
</dl>
</div>
<div class="section" id="amperes-task-manthan-upadhyaya">
<h2>Amperes Task: Manthan Upadhyaya<a class="headerlink" href="#amperes-task-manthan-upadhyaya" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>Purpose</dt>
<dd>Monitor the current and call the Fault state task if it is dangerously high.</dd>
<dt>Functionality</dt>
<dd><ol class="first last arabic simple">
<li>First it checks the current and if it is safe, posts the SafetyCheck_Sem4. This only occurs once.</li>
<li>If the current is above 75A, it sets the Fault_Sem4.</li>
<li>After every updated measurement, it sends the current data to the Can queue.</li>
</ol>
</dd>
<dt>Priority</dt>
<dd>This task is the 5th priority, under the VoltTemp task.</dd>
<dt>Shared Resources</dt>
<dd>It uses the Fault_Sem4, SafetyCheck_Sem4, AmperesData_Mutex(when collecting data from the
current sensor), and AmperesIO_Sem4.</dd>
<dt>Timing Requirements</dt>
<dd>TBD</dd>
<dt>Yields</dt>
<dd>Never yields</dd>
<dt>Additional Considerations</dt>
<dd>None</dd>
</dl>
</div>
<div class="section" id="critical-state-task-manthan-upadhyaya">
<h2>Critical State Task: Manthan Upadhyaya<a class="headerlink" href="#critical-state-task-manthan-upadhyaya" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>Purpose</dt>
<dd>The Critical State Task initializes the BPS when it first turns on.</dd>
<dt>Functionality:</dt>
<dd><ol class="first last arabic simple">
<li>It waits for the VoltTemp and Amperes task to post the SafetyCheck semaphore 4 times. One for voltage, one for temperature, one for current, and one for open wire.</li>
<li>If all of these checks are safe, the task will send the All Clear message and the Contactor On message across the CAN line.</li>
<li>The task will then destroy itself since it is no longer needed</li>
</ol>
</dd>
<dt>Priority</dt>
<dd>It’s priority 2, underneath the fault state task.</dd>
<dt>Shared Resources</dt>
<dd>All it uses is the SafetyCheck_Sem4.</dd>
<dt>Timing Requirements</dt>
<dd>Runs once at BPS startup.</dd>
<dt>Yields</dt>
<dd>After it initializes, it destroys itself.</dd>
<dt>Additional Considerations</dt>
<dd>None</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="BSP.html" class="btn btn-neutral float-right" title="Board Support Package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../Overview/design-overview.html" class="btn btn-neutral float-left" title="Design Overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, LHR Solar

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>